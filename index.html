<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Una sorpresa para ti, Sahla 💛</title>
  <link href="https://fonts.googleapis.com/css2?family=Sacramento&family=Nunito:wght@300;600;800&display=swap" rel="stylesheet" />
  <style>
    :root{
      /* Paleta dorada/amarilla + crema */
      --bg1:#fffdf6; --bg2:#fffbea;
      --text:#422006; --muted:#6b4a09;
      --amber1:#facc15; --amber2:#fcd34d; --amber3:#fde68a;
      --paper:#ffffff;
    }
    *{box-sizing:border-box}
    html{scroll-behavior:smooth;}
    body{
      margin:0; font-family:'Nunito',sans-serif; color:var(--text);
      background:linear-gradient(160deg,var(--bg1),var(--bg2)); overflow-x:hidden;
    }

    /* ====== JUEGO DE SECUENCIA (SIMON) ====== */
    .game-overlay {
        position: fixed; inset: 0; z-index: 600;
        display: flex; flex-direction: column;
        justify-content: center; align-items: center;
        background-image: linear-gradient(rgba(255, 253, 246, 0.9), rgba(255, 253, 246, 0.98)), url('https://img.freepik.com/vector-gratis/fondo-acuarela-rosa-pintado-mano-detallado_1048-17039.jpg');
        background-size: cover; background-position: center;
        transition: opacity .8s ease-out, visibility .8s ease-out;
    }
    .game-overlay[hidden] {
        opacity: 0;
        visibility: hidden;
    }
    .game-container {
        text-align: center;
        background: var(--paper);
        padding: clamp(20px, 5vw, 40px);
        border-radius: 20px;
        box-shadow: 0 10px 40px rgba(0,0,0,0.2);
    }
    .game-title {
        font-family: 'Sacramento', cursive;
        font-size: clamp(40px, 8vw, 58px);
        color: #a16207;
        margin: 0 0 10px;
    }
    .game-status {
        font-size: 16px;
        color: var(--muted);
        min-height: 24px;
        margin-bottom: 20px;
        font-weight: bold;
    }
    .simon-pads {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 15px;
        width: clamp(280px, 70vw, 350px);
        margin: 0 auto;
    }
    .simon-pad {
        width: 100%;
        aspect-ratio: 1 / 1;
        border-radius: 16px;
        cursor: pointer;
        transition: transform 0.1s, box-shadow 0.2s;
        box-shadow: 0 5px 15px rgba(0,0,0,0.15);
        border: 2px solid rgba(255,255,255,0.8);
    }
    .simon-pad:hover { transform: scale(1.03); }
    .simon-pad.active {
        transform: scale(0.95);
        box-shadow: 0 0 25px var(--glow-color), inset 0 0 15px rgba(255,255,255,0.5);
        filter: brightness(1.3);
    }
    .simon-pad[data-color="1"] { background: #d97706; --glow-color: #fbbf24; }
    .simon-pad[data-color="2"] { background: #ca8a04; --glow-color: #fde047; }
    .simon-pad[data-color="3"] { background: #a16207; --glow-color: #facc15; }
    .simon-pad[data-color="4"] { background: #b45309; --glow-color: #fcd34d; }
    
    #startGameBtn { margin-top: 25px; }

    /* ====== MODALES DE LOGIN (Usuario y Admin) ====== */
    .login-overlay {
      position:fixed; inset:0; z-index:500;
      display:grid; place-items:center;
      background-image: linear-gradient(rgba(255, 253, 246, 0.85), rgba(255, 253, 246, 0.95)), url('https://img.freepik.com/vector-gratis/fondo-acuarela-rosa-pintado-mano-detallado_1048-17039.jpg');
      background-size:cover; background-position:center;
      backdrop-filter:blur(8px);
      opacity:0; animation: fadeInModal .8s ease forwards;
    }
    .login-overlay.show { opacity: 1; }
    .login-overlay[hidden]{ display:none; }
    @keyframes fadeInModal { to { opacity: 1; } }

    .login-card{
      background:var(--paper); padding:28px 32px; border-radius:16px;
      box-shadow:0 10px 30px rgba(0,0,0,.2); width:min(90vw, 360px);
      text-align:center;
      opacity:0; transform: translateY(20px);
      animation: slideUpModal .7s .3s ease forwards;
    }
    @keyframes slideUpModal { to { opacity:1; transform:translateY(0); } }

    .login-card h3{
      margin:0 0 8px; font-weight:800; color:#a16207; font-size:38px;
      font-family: 'Sacramento', cursive;
    }
    .login-card .hint{ font-size:14px; color:var(--muted); margin-bottom:20px; }
    .login-card input{
      width:100%; padding:12px; margin-bottom:12px; border:1px solid var(--amber3);
      border-radius:8px; font-size:16px; text-align:center;
      transition: box-shadow .3s, border-color .3s;
    }
    .login-card input:focus {
      outline: none; border-color: var(--amber1); box-shadow: 0 0 10px rgba(250, 204, 21, .5);
    }
    .login-actions{display:flex; gap:10px; justify-content:center; margin-top:8px;}
    .login-error-msg{color:#b91c1c; font-size:13px; font-weight:bold; margin-top:12px; text-align:center; display:none;}
    .admin-switch { margin-top: 20px; font-size: 12px; }
    .admin-switch a { color: var(--muted); cursor: pointer; text-decoration: underline; }

    /* ====== FLORES DE FONDO ====== */
    .bg-decor{position:fixed;left:0;right:0;top:0;bottom:84px;z-index:0;pointer-events:none;overflow:hidden}
    .float-img{
      position:absolute; opacity:.8; width:clamp(80px,10vw,130px);
      animation:floatY linear infinite; filter:drop-shadow(0 0 14px rgba(250,204,21,.45));
    }
    @keyframes floatY{ 0%{transform:translateY(110%) rotate(0) scale(var(--s,1))} 100%{transform:translateY(-120%) rotate(360deg) scale(var(--s,1))} }

    /* ====== GATE (Login + Cuestionario) ====== */
    .gate{
      position:fixed; inset:0; display:grid; place-items:center;
      background:rgba(255,255,255,.96); backdrop-filter:blur(8px);
      z-index:300; padding:20px; overflow-y:auto;
    }
    .gate[hidden]{display:none}
    .gate-card{
      width:min(96vw,820px); background:var(--paper);
      border:1px solid #facc1580; border-radius:22px;
      box-shadow:0 12px 36px rgba(0,0,0,.22);
      padding:clamp(18px, 4vw, 26px) clamp(16px, 4vw, 22px);
    }
    .gate-title{ font-family:'Sacramento',cursive; font-size:clamp(42px, 8vw, 52px); margin:0 0 6px; color:#d97706; text-align:center; }
    .gate-sub{color:var(--muted); text-align:center; margin:0 0 14px; font-size:15px}
    .step-badge{
      display:inline-block; padding:6px 12px; border-radius:999px; font-weight:800;
      background:linear-gradient(90deg,var(--amber1),var(--amber2)); color:#3a2a05; font-size:13px; margin:6px 0 12px;
    }
    .name-fields label{display:block; margin:.4rem 0 .2rem; font-weight:800; color:#a16207}
    .name-fields input{
      width:100%; padding:12px 14px; font-size:16px; text-align:center;
      border-radius:12px; border:1px solid #facc15a6; outline:none;
      background:#fff; color:#5b3a06; box-shadow:0 3px 12px rgba(0,0,0,.06) inset;
    }
    .gate-actions{display:flex; gap:10px; justify-content:center; margin-top:14px; flex-wrap:wrap}
    .btn{
      border:none; border-radius:999px; padding:12px 22px; font-weight:800; cursor:pointer;
      background:linear-gradient(90deg,var(--amber1),var(--amber2)); color:#3a2a05;
      box-shadow:0 6px 18px rgba(0,0,0,.18); transition:transform .25s;
    }
    .btn:hover{transform:scale(1.04)}
    .error-msg{display:none; color:#b91c1c; font-weight:800; margin-top:8px; text-align:center}
    .ok-msg{display:none; color:#16a34a; font-weight:800; margin-top:8px; text-align:center}

    .q{margin:12px 0 6px; font-weight:800; color:#a16207}
    .option{display:inline-block; margin:6px 10px; padding:6px 12px; border-radius:999px; background:#fff7ed; border:1px solid #facc1566}

    /* ====== CONTENIDO ====== */
    .shell{min-height:100vh; display:flex; justify-content:center; align-items:center; padding:24px; position:relative; z-index:1}
    .shell[hidden]{display:none;}
    .hero{
      width:min(100%,1050px); border-radius:22px; text-align:center; background:rgba(255,255,255,.92);
      box-shadow:0 12px 36px rgba(0,0,0,.22); padding: clamp(24px, 5vw, 36px) clamp(16px, 4vw, 26px);
      opacity:0; animation: fadeInContent 1s ease forwards; position:relative;
    }
    @keyframes fadeInContent{ to{opacity:1;} }
    h1{ margin:0; font-weight:800; font-size:clamp(36px,8vw,74px); font-family:'Sacramento',cursive; color:#d97706; transition: text-shadow .4s ease; cursor: default; }
    h1:hover{ text-shadow: 0 0 12px rgba(250,204,21,.8); }
    .subtitle{color:var(--muted); margin:10px 0 20px; font-size: clamp(16px, 4vw, 18px);}
    .grid{display:grid; grid-template-columns:repeat(auto-fit,minmax(220px,1fr)); gap:16px; margin:10px 0 18px}
    .card{
      border-radius:16px; background:var(--card); padding:16px;
      border:1px solid #facc1550; box-shadow:0 4px 12px rgba(0,0,0,.12);
      font-weight:800; color:#a16207; opacity:0; animation: slideUp .6s ease forwards;
    }
    .card:nth-child(2){animation-delay: .1s;} .card:nth-child(3){animation-delay: .2s;}
    @keyframes slideUp { from{opacity:0; transform:translateY(20px);} to{opacity:1; transform:translateY(0);} }
    .yt-link{ display:inline-block; margin-top:8px; background:var(--amber2); color:#3a2a05; text-decoration:none; padding:6px 12px; font-size:12px; border-radius:999px; font-weight:bold; transition: all .3s ease; box-shadow: 0 2px 5px rgba(0,0,0,.15); }
    .yt-link:hover{transform:scale(1.05); box-shadow: 0 4px 8px rgba(0,0,0,.2);}
    .love-letter{ margin-top:24px; padding:20px; background:#fffdf6; border-radius:16px; box-shadow:0 6px 16px rgba(0,0,0,.15); font-size: clamp(16px, 4vw, 18px); line-height:1.7; white-space:pre-line; min-height:170px; opacity:0; transition:opacity .9s ease; }
    .love-letter.visible{opacity:1}
    .signature{font-family:'Sacramento',cursive; font-size:34px; color:#a16207; margin-top:16px; opacity:0; transition:opacity .6s}
    .signature.show{opacity:1}
    .gallery-container { margin: 24px auto 0; max-width: 350px; position: relative; }
    .gallery-slide { display: none; }
    .gallery-slide.active { display: block; }
    .gallery-photo img { width: 210px; height: 210px; object-fit: cover; border-radius: 50%; border: 6px solid var(--amber2); box-shadow: 0 0 30px rgba(250,204,21,.5); animation: pulse 2.5s infinite ease-in-out; }
    @keyframes pulse { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.03); } }
    .gallery-nav { position: absolute; top: 50%; width: calc(100% + 40px); left: -20px; display: flex; justify-content: space-between; transform: translateY(-50%); }
    .gallery-nav button { background: rgba(255,255,255,.8); border: 1px solid var(--amber3); border-radius: 50%; width: 40px; height: 40px; cursor: pointer; font-size: 20px; color: var(--muted); box-shadow: 0 2px 6px rgba(0,0,0,.15); }
    .photo-caption { margin-top: 12px; font-weight: 600; color: var(--muted); font-size: 14px; min-height: 20px; }
    .media-actions-container { display: flex; flex-direction: column; align-items: center; gap: 20px; margin-top: 24px; }
    .music-box{ padding:14px; border-radius:14px; background:#fffef8; box-shadow:0 4px 12px rgba(0,0,0,.15); display:none; width:100%; max-width:450px; }
    .music-box p{margin:0 0 8px; font-weight:800; color:#a16207}
    audio{display:none}
    .custom-player{ display:flex; align-items:center; gap:10px; }
    #playPauseBtn{ background:var(--amber2); border:none; border-radius:50%; width:40px; height:40px; cursor:pointer; display:flex; justify-content:center; align-items:center; box-shadow: 0 2px 5px rgba(0,0,0,.2); flex-shrink:0; }
    #playPauseBtn svg{width:20px; height:20px; fill:#3a2a05;}
    .progress-container{ flex-grow:1; background:#fde68a; height:8px; border-radius:999px; cursor:pointer; }
    .progress-bar{ background:linear-gradient(90deg,var(--amber1),var(--amber2)); height:100%; width:0%; border-radius:999px; }
    .time-display{ font-size:12px; font-weight:800; color:#a16207; }
    .volume-control{display:flex; align-items:center; gap:8px;}
    .volume-control svg{width:20px; height:20px; fill:#a16207;}
    #volumeSlider{ -webkit-appearance:none; appearance:none; width:80px; height:6px; background:#fde68a; outline:none; border-radius:999px; cursor:pointer; }
    #volumeSlider::-webkit-slider-thumb{ -webkit-appearance:none; appearance:none; width:14px; height:14px; background:var(--amber2); border:2px solid #fff; border-radius:50%; cursor:pointer; box-shadow:0 1px 3px rgba(0,0,0,.2); }
    #volumeSlider::-moz-range-thumb{ width:14px; height:14px; background:var(--amber2); border:2px solid #fff; border-radius:50%; cursor:pointer; box-shadow:0 1px 3px rgba(0,0,0,.2); }
    .action-buttons { display: flex; flex-wrap:wrap; justify-content:center; align-items:center; gap:15px; }
    .action-btn { display: flex; align-items: center; gap: 8px; padding: 12px 22px; border:none; border-radius:24px; color:#3a2a05; font-weight:800; cursor:pointer; font-size:14px; box-shadow:0 4px 12px rgba(0,0,0,.18); transition: all .3s ease; }
    .action-btn svg { width: 18px; height: 18px; fill: #3a2a05; }
    .surprise-btn { background:linear-gradient(135deg,var(--amber1),var(--amber2)); }
    .apology-btn { background: #fff; border: 1px solid var(--amber2); }
    .reason-btn { background: linear-gradient(135deg, #fde68a, #fcd34d); }
    .action-btn:hover {transform:scale(1.05); box-shadow:0 6px 16px rgba(0,0,0,.22);}
    .modal-overlay{position:fixed; inset:0; display:none; place-items:center; background:rgba(255,255,255,.92); z-index:200}
    .modal-box{ background:#fff; padding:22px 36px; border-radius:20px; box-shadow:0 0 26px rgba(250,204,21,.4); opacity:0; transform:scale(.9); transition:all .8s ease; width: min(90vw, 600px); }
    .modal-overlay.show .modal-box{opacity:1; transform:scale(1)}
    .final-box{ font-family:'Sacramento',cursive; font-size:clamp(36px,6vw,64px); color:#a16207; }
    .apology-box p, .reason-box p { font-size: 18px; line-height: 1.6; color: var(--muted); text-align: center; white-space: normal; font-weight: 600;}
    .close-modal-btn { margin-top: 20px; font-size: 14px; cursor: pointer; font-weight: bold; color: #a16207; }
    .heart-particle { position: absolute; font-size: 20px; pointer-events: none; animation: fall linear forwards; z-index: 100; }
    @keyframes fall { to { transform: translateY(150px) rotate(90deg); opacity: 0; } }
    #secretOverlay { background: rgba(0,0,0,0.95); }
    #secretContent { font-family: monospace; color: #39ff14; font-size: 16px; white-space: pre; text-shadow: 0 0 5px #39ff14; line-height: 1.5; width: min(90vw, 800px); text-align: left; }
    #secretContent::after { content: '▋'; animation: blink 1s step-end infinite; }
    @keyframes blink { 50% { opacity: 0; } }
    footer{ text-align:center; padding:15px; background:linear-gradient(90deg,#fde68a,#fcd34d); color:#3a2a05; font-size:13px; box-shadow:0 -2px 6px rgba(0,0,0,.15); position:relative; z-index:10; font-weight:bold; }
    footer[hidden]{display:none;}
    #footerPhrase{font-size:12px; font-weight:700; transition:opacity .4s}
    .secret-hint { font-size: 11px; color: var(--muted); margin-top: 8px; font-style: italic; cursor: pointer; }
    @media (max-width: 768px){ .grid{ grid-template-columns: 1fr; } .custom-player { flex-wrap: wrap; justify-content: center; } .progress-container { order: -1; width: 100%; margin-bottom: 10px; } #secretContent { font-size: 12px; } }
  </style>
</head>
<body>

  <div id="simonGameOverlay" class="game-overlay">
      <div class="game-container">
          <h2 class="game-title">Prueba de Memoria</h2>
          <div id="gameStatus" class="game-status">Repite la secuencia para continuar</div>
          <div class="simon-pads" id="simonPads">
              <div class="simon-pad" data-color="1"></div>
              <div class="simon-pad" data-color="2"></div>
              <div class="simon-pad" data-color="3"></div>
              <div class="simon-pad" data-color="4"></div>
          </div>
          <div class="gate-actions">
              <button id="startGameBtn" class="btn">Comenzar</button>
          </div>
          <div class="admin-switch">
              <a id="showAdminBtnFromGame">Acceso Ivo Mathias</a>
          </div>
      </div>
  </div>
  <div id="userLoginModal" class="login-overlay" hidden>
    <div class="login-card">
      <h3>¡Lo lograste!</h3>
      <p class="hint">Ahora sí, para entrar, necesito saber que eres tú.</p>
      <form id="userLoginForm">
        <input type="text" id="loginUser" placeholder="¿Quién es la reina de esta página?" required>
        <input type="password" id="loginPass" placeholder="El nombre del tazmania" required>
        <div id="userLoginError" class="login-error-msg">Intenta de nuevo, mi amor.</div>
        <div class="login-actions">
          <button type="submit" class="btn">Desbloquear Sorpresa</button>
        </div>
      </form>
    </div>
  </div>

  <div id="adminModal" class="login-overlay" hidden>
    <div class="login-card">
        <h3>Acceso Personal</h3>
        <p class="hint">¿Usted cree que haria el juego mil veces para probar el juego?? ÑOCREO</p>
        <form id="adminForm">
            <input type="text" id="adminUser" placeholder="Usuario" value="admin">
            <input type="password" id="adminPass" placeholder="Contraseña">
            <div id="adminLoginError" class="login-error-msg">Credenciales incorrectas.</div>
            <div class="login-actions">
                <button type="submit" class="btn">Ingresar Y ERA</button>
            </div>
        </form>
         <div class="admin-switch">
            <a id="showUserBtn">Volver al juego</a>
        </div>
    </div>
</div>

  <div class="bg-decor" id="bgDecor"></div>

  <section id="gate" class="gate" hidden>
    <div class="gate-card">
      <h2 class="gate-title">Bienvenida Mi Amor 💛</h2>
      <div id="nameSection">
        <p class="gate-sub" style="margin-bottom:0;">Ahora, para continuar, verifica tus nombres.<br>Usa <b>solo primer nombre y primer apellido</b> con mayúsculas iniciales.</p>
        <div class="step-badge">Paso 1 · Nombres</div>
        <div class="name-fields">
          <label for="nombre">Tu Nombre</label>
          <input type="text" id="nombre" autocomplete="off" />
          <label for="nombreNovio">Nombre de tu Novio</label>
          <input type="text" id="nombreNovio" autocomplete="off" />
          <div class="gate-actions">
            <button id="validarBtn" class="btn">Validar nombres</button>
            <button id="limpiarBtn" class="btn" type="button" style="background:linear-gradient(90deg,#fde68a,#facc15);">Limpiar</button>
          </div>
          <p id="errorMsg" class="error-msg">❌ MAL MAL.</p>
          <p id="okMsg" class="ok-msg">✅ ¡Perfecto! Continúa con el cuestionario.</p>
        </div>
      </div>
      <div id="quizWrap" style="display:none; margin-top:8px;">
        <div class="step-badge">Paso 2 · Cuestionario</div>
        <form id="quizForm">
          <div id="quizMount"></div>
          <div class="gate-actions">
            <button type="submit" class="btn">Comprobar respuestas</button>
          </div>
          <p id="quizStatus" class="error-msg" style="display:none"></p>
          <p id="quizOk" class="ok-msg" style="display:none">🎉 ¡Esoooo Mi Amor! Entrando…</p>
        </form>
      </div>
    </div>
  </section>

  <main class="shell" hidden>
    <div class="hero" id="hero-area">
      <h1 id="mainTitle">Para ti, Mi Amor</h1>
      <p class="subtitle" id="dynamicSubtitle">Que estas flores iluminen tu día como tú iluminas mi vida.</p>
      <div class="grid">
        <div class="card">Un deseo: que en un tiempo mas amanezcamos juntitos ✨</div>
        <div class="card">Una promesa: regalarte sonrisas diarias y mi amor infinito 💛</div>
        <div class="card">
          Una canción: Bonita - Gino Mella
          <a href="https://www.youtube.com/watch?v=gP0cno-xkH8&list=RDgP0cno-xkH8&start_radio=1" target="_blank" rel="noopener noreferrer" class="yt-link">Escuchar en YouTube 🎵</a>
        </div>
      </div>
      <div id="loveLetter" class="love-letter"></div>
      <div class="signature" id="signature">Con todo mi corazón, tu amor ✨</div>
      <div class="gallery-container">
        <div class="gallery-slide active" data-index="0"><div class="gallery-photo"><img src="https://i.imgur.com/wHZfez2.jpeg" alt="Nosotros 1"></div></div>
        <div class="gallery-slide" data-index="1"><div class="gallery-photo"><img src="https://i.imgur.com/o9dyEBS.jpeg" alt="Nosotros 2"></div></div>
        <div class="gallery-slide" data-index="2"><div class="gallery-photo"><img src="https://i.imgur.com/te2wIIM.jpeg" alt="Nosotros 3"></div></div>
        <div class="gallery-nav"><button id="prevBtn">‹</button><button id="nextBtn">›</button></div>
        <div class="photo-caption" id="photoCaption"></div>
      </div>
      <div class="media-actions-container">
        <div class="music-box" id="musicBox">
          <p>Nuestra canción 🎶</p>
          <audio id="musicPlayer" preload="auto"><source src="https://files.catbox.moe/otu488.mp3" type="audio/mpeg"></audio>
          <div class="custom-player">
            <button id="playPauseBtn">
              <svg id="playIcon" viewBox="0 0 24 24"><path d="M8,5.14V19.14L19,12.14L8,5.14Z"></path></svg>
              <svg id="pauseIcon" viewBox="0 0 24 24" style="display:none;"><path d="M14,19H18V5H14M6,19H10V5H6V19Z"></path></svg>
            </button>
            <div class="time-display" id="currentTime">00:00</div>
            <div class="progress-container" id="progressContainer"><div class="progress-bar" id="progressBar"></div></div>
            <div class="time-display" id="totalTime">00:00</div>
            <div class="volume-control">
              <svg viewBox="0 0 24 24"><path d="M14,3.23V5.29C16.89,6.15 19,8.83 19,12C19,15.17 16.89,17.84 14,18.7V20.77C18,19.86 21,16.28 21,12C21,7.72 18,4.14 14,3.23M16.5,12C16.5,10.23 15.5,8.71 14,7.97V16C15.5,15.29 16.5,13.76 16.5,12M3,9V15H7L12,20V4L7,9H3Z"></path></svg>
              <input type="range" id="volumeSlider" min="0" max="100" value="100">
            </div>
          </div>
        </div>
        <div class="action-buttons">
          <button class="action-btn surprise-btn" id="surpriseBtn"><svg viewBox="0 0 24 24"><path d="M21,16.5C21,16.88 20.79,17.21 20.47,17.38L12.57,21.82C12.41,21.94 12.21,22 12,22C11.79,22 11.59,21.94 11.43,21.82L3.53,17.38C3.21,17.21 3,16.88 3,16.5V7.5C3,7.12 3.21,6.79 3.53,6.62L11.43,2.18C11.59,2.06 11.79,2 12,2C12.21,2 12.41,2.06 12.57,2.18L20.47,6.62C20.79,6.79 21,7.12 21,7.5V16.5M12,4.15L5,8.09V15.91L12,19.85L19,15.91V8.09L12,4.15Z"></path></svg> Sorpresa</button>
          <button class="action-btn apology-btn" id="apologyBtn"><svg viewBox="0 0 24 24"><path d="M20,8L12,13L4,8V6L12,11L20,6M20,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V6C22,4.89 21.1,4 20,4Z"></path></svg> Unas palabras</button>
          <button class="action-btn reason-btn" id="reasonBtn"><svg viewBox="0 0 24 24"><path d="M12,21.35L10.55,20.03C5.4,15.36 2,12.27 2,8.5C2,5.41 4.42,3 7.5,3C9.24,3 10.91,3.81 12,5.08C13.09,3.81 14.76,3 16.5,3C19.58,3 22,5.41 22,8.5C22,12.27 18.6,15.36 13.45,20.03L12,21.35Z"></path></svg> Te amo porque...</button>
        </div>
      </div>
    </div>
  </main>

  <div id="finalLove" class="modal-overlay"><div id="finalBox" class="modal-box final-box"></div></div>
  <div id="apologyModal" class="modal-overlay"><div class="modal-box apology-box"><p>Perdón amor por hacértelo por acá pero es una forma de cumplirle el día, yo la amo mucho y quería por lo menos hacerle el detalle, ud sabe que no puedo por que es día de visita y es domingo aparte semana de fiestas patrias pero en la semana le recompensaré pero mientras me dedique a hacerle toda esta programación espero que le guste, te amo con mi vida.</p><div class="close-modal-btn" id="closeApology">Cerrar</div></div></div>
  <div id="reasonModal" class="modal-overlay"><div class="modal-box reason-box"><p id="reasonText"></p><div class="close-modal-btn" id="closeReason">Cerrar</div></div></div>
  <div id="secretOverlay" class="modal-overlay"><pre id="secretContent"></pre></div>

  <footer hidden>
    <div>Creado con 💛 por Ivo Mathias © 2025</div>
    <div id="footerPhrase"></div>
    <div class="secret-hint" id="secretHint">P.D. Hay un secreto para ti si sabes dónde buscar 😉</div>
  </footer>

<script>
    /* ====== CONFIG ====== */
    const REQUIRED_HER = "Sahla Balut";
    const REQUIRED_HIM = "Ivo Caneo";
    const FLOWER_IMG = "https://i.imgur.com/0QYDEU4.png";
    const WIN_LEVEL = 8; // Nivel para ganar el juego de secuencia
    const PHOTO_CAPTIONS = ["El comienzo de nuestra historia.","Recuerdo de un día inolvidable.","Mirando siempre hacia el futuro, juntos."];
    const LOVE_REASONS = ["tu increíble capacidad de hacerme sonreír.","contigo hasta el silencio es cómodo.","la forma en que tus ojos brillan cuando estás feliz.","me inspiras a ser una mejor persona cada día.","tu fortaleza y tu ternura.","cada momento contigo se siente como una aventura.","tu risa es mi canción favorita.","me amas con todos mis defectos."];
    const SECRET_MESSAGE = `
    Iniciando protocolo 'TUKI.exe'...
    Conexión segura establecida con el corazón de Sahla.
    
    Hola, mi amor.
    
    Si encontraste esto, es porque tu curiosidad es tan grande
    como mi amor por ti.
    
    Quería dejarte un pedacito de mi corazón también aquí,
    en el lenguaje que usé para construir esta sorpresa.
    
          ****************
       ********************
     ************************
    **************************
   ****************************
   ****************************
    **************************
      **********************
        ******************
          **************
            **********
              ******
                **
    
    Te amo más de lo que las palabras (o el código)
    pueden expresar.
    
    Transmisión finalizada. Te amo siempre.
    `;
    const QUIZ_QUESTIONS = [{q:"¿Cual es el dia siguiente a vernos?",options:["Martes","Sabado","Jueves"],answer:1},{q:"¿De qué color son las flores de hoy?",options:["Rojas","Amarillas","Azules"],answer:1},{q:"Completa: TU",options:["Amor","KI","Vida"],answer:1}];
    const surpriseMessages = ["💖 Siempre juntos, te amo para siempre 💛","🌻 Te amo con mi vida","✨ Eres mi hogar y mi destino","💕 Gracias por ser mi luz y mi alegría"];
    const footerPhrases = ["🌻 Hoy y siempre a tu lado","💛 Mi corazón siempre será tuyo","✨ Eres mi destino y mi paz","🎁 Cada día contigo es un regalo"];

    /* ====== ELEMENTOS ====== */
    const simonGameOverlay = document.getElementById('simonGameOverlay');
    const userLoginModal = document.getElementById('userLoginModal');
    const userLoginForm = document.getElementById('userLoginForm');
    const userLoginError = document.getElementById('userLoginError');
    const adminModal = document.getElementById('adminModal');
    const adminForm = document.getElementById('adminForm');
    const adminLoginError = document.getElementById('adminLoginError');
    const showAdminBtnFromGame = document.getElementById('showAdminBtnFromGame');
    const showUserBtn = document.getElementById('showUserBtn');
    const heroArea = document.getElementById('hero-area');
    const reasonBtn = document.getElementById('reasonBtn');
    const reasonModal = document.getElementById('reasonModal');
    const reasonText = document.getElementById('reasonText');
    const closeReasonBtn = document.getElementById('closeReason');
    const secretHint = document.getElementById('secretHint');
    const secretOverlay = document.getElementById('secretOverlay');
    const secretContent = document.getElementById('secretContent');
    const gate = document.getElementById('gate');
    const mainShell = document.querySelector('.shell');
    const mainFooter = document.querySelector('footer');
    const nameSection = document.getElementById('nameSection');
    const quizWrap = document.getElementById('quizWrap');
    const validarBtn = document.getElementById('validarBtn');
    const limpiarBtn = document.getElementById('limpiarBtn');
    const nombreInput = document.getElementById('nombre');
    const nombreNovioInput = document.getElementById('nombreNovio');
    const errorMsg = document.getElementById('errorMsg');
    const okMsg = document.getElementById('okMsg');
    const quizForm = document.getElementById('quizForm');
    const quizMount = document.getElementById('quizMount');
    const quizStatus = document.getElementById('quizStatus');
    const quizOk = document.getElementById('quizOk');
    const loveLetter = document.getElementById('loveLetter');
    const signature = document.getElementById('signature');
    const musicBox = document.getElementById('musicBox');
    const music = document.getElementById('musicPlayer');
    const playPauseBtn = document.getElementById('playPauseBtn');
    const playIcon = document.getElementById('playIcon');
    const pauseIcon = document.getElementById('pauseIcon');
    const progressBar = document.getElementById('progressBar');
    const progressContainer = document.getElementById('progressContainer');
    const currentTimeEl = document.getElementById('currentTime');
    const totalTimeEl = document.getElementById('totalTime');
    const volumeSlider = document.getElementById('volumeSlider');
    const bgDecor = document.getElementById('bgDecor');
    const footerPhraseEl = document.getElementById('footerPhrase');
    const surpriseBtn = document.getElementById('surpriseBtn');
    const finalLove = document.getElementById('finalLove');
    const finalBox = document.getElementById('finalBox');
    const apologyBtn = document.getElementById('apologyBtn');
    const apologyModal = document.getElementById('apologyModal');
    const closeApologyBtn = document.getElementById('closeApology');

    let validatedHerName = "";
    let msgIndex = 0;

    /* ====== 🧠 LÓGICA DEL JUEGO DE SECUENCIA ====== */
    const gameStatusEl = document.getElementById('gameStatus');
    const simonPadsContainer = document.getElementById('simonPads');
    const startGameBtn = document.getElementById('startGameBtn');
    
    let sequence = [];
    let playerSequence = [];
    let level = 0;
    let gameActive = false;
    let showingSequence = false;

    const flashPad = (color) => {
        const pad = simonPadsContainer.querySelector(`[data-color="${color}"]`);
        pad.classList.add('active');
        try {
            const ctx = new (window.AudioContext || window.webkitAudioContext)();
            const osc = ctx.createOscillator();
            osc.type = 'sine';
            osc.frequency.setValueAtTime(220 * Math.pow(2, (color * 2) / 12), ctx.currentTime);
            osc.connect(ctx.destination);
            osc.start();
            osc.stop(ctx.currentTime + 0.2);
        } catch(e) { /* AudioContext puede fallar */ }
        
        setTimeout(() => pad.classList.remove('active'), 300);
    };

    const playSequence = async () => {
        showingSequence = true;
        gameStatusEl.textContent = "Memoriza Amor Tu Puedes...";
        await new Promise(resolve => setTimeout(resolve, 800));
        for (const color of sequence) {
            await new Promise(resolve => setTimeout(resolve, 150));
            flashPad(color);
            await new Promise(resolve => setTimeout(resolve, 350));
        }
        gameStatusEl.textContent = `Tu turno (Nivel ${level})`;
        showingSequence = false;
    };

    const nextLevel = () => {
        level++;
        playerSequence = [];
        const nextColor = Math.floor(Math.random() * 4) + 1;
        sequence.push(nextColor);
        playSequence();
    };
    
    const startGame = () => {
        sequence = [];
        level = 0;
        gameActive = true;
        startGameBtn.style.display = 'none';
        nextLevel();
    };
    
    const gameOver = () => {
        gameStatusEl.textContent = '¡Error! Vuelve a intentarlo.';
        gameActive = false;
        startGameBtn.style.display = 'block';
    };

    const playerTurn = (color) => {
        if (!gameActive || showingSequence) return;
        
        playerSequence.push(color);
        flashPad(color);
        
        const currentStep = playerSequence.length - 1;
        if (playerSequence[currentStep] !== sequence[currentStep]) {
            gameOver();
            return;
        }

        if (playerSequence.length === sequence.length) {
            if (level >= WIN_LEVEL) {
                gameStatusEl.textContent = '¡Increíble memoria! Acceso concedido.';
                setTimeout(() => {
                    simonGameOverlay.hidden = true;
                    userLoginModal.hidden = false;
                    userLoginModal.classList.add('show');
                }, 1500);
            } else {
                nextLevel();
            }
        }
    };

    startGameBtn.addEventListener('click', startGame);
    simonPadsContainer.addEventListener('click', (e) => {
        if (e.target.classList.contains('simon-pad')) {
            const color = parseInt(e.target.dataset.color, 10);
            playerTurn(color);
        }
    });

    /* ====== LÓGICA DE INICIO DE SESIÓN Y FLUJO ====== */
    userLoginForm.addEventListener('submit', (e) => {
      e.preventDefault();
      const user = document.getElementById('loginUser').value;
      const pass = document.getElementById('loginPass').value;
      if (user.toLowerCase() === 'sahla' && pass.toLowerCase() === 'ferran') {
        userLoginModal.hidden = true;
        gate.hidden = false;
      } else {
        userLoginError.style.display = 'block';
      }
    });

    adminForm.addEventListener('submit', (e) => {
        e.preventDefault();
        const user = document.getElementById('adminUser').value;
        const pass = document.getElementById('adminPass').value;
        if (user === 'admin' && pass === 'enero7') {
            adminModal.hidden = true;
            simonGameOverlay.hidden = true;
            userLoginModal.hidden = true;
            gate.hidden = true;
            mainShell.hidden = false;
            mainFooter.hidden = false;
            startRomanceSequence();
        } else {
            adminLoginError.style.display = 'block';
        }
    });
    
    showAdminBtnFromGame.addEventListener('click', () => {
        simonGameOverlay.hidden = true;
        adminModal.hidden = false;
        adminModal.classList.add('show');
    });

    showUserBtn.addEventListener('click', () => {
        adminModal.hidden = true;
        simonGameOverlay.hidden = false;
    });

    /* ====== SALUDO DINÁMICO ====== */
    const dynamicSubtitle = document.getElementById('dynamicSubtitle');
    const currentHour = new Date().getHours();
    if (currentHour < 12) {
        dynamicSubtitle.textContent = "Que estas flores iluminen tu mañana como tú iluminas mi vida.";
    } else if (currentHour < 19) {
        dynamicSubtitle.textContent = "Que estas flores decoren tu tarde como tú decoras mi mundo.";
    } else {
        dynamicSubtitle.textContent = "Que estas flores velen tus sueños como yo velo por ti.";
    }
    
    /* ====== GALERÍA DE FOTOS ====== */
    const slides = document.querySelectorAll('.gallery-slide');
    const captionEl = document.getElementById('photoCaption');
    let currentSlide = 0;

    function showSlide(index) {
        slides.forEach((slide, i) => {
            slide.classList.toggle('active', i === index);
        });
        captionEl.textContent = PHOTO_CAPTIONS[index];
    }

    document.getElementById('nextBtn').addEventListener('click', () => {
        currentSlide = (currentSlide + 1) % slides.length;
        showSlide(currentSlide);
    });

    document.getElementById('prevBtn').addEventListener('click', () => {
        currentSlide = (currentSlide - 1 + slides.length) % slides.length;
        showSlide(currentSlide);
    });
    
    showSlide(0);

    /* ====== BOTONES DE ACCIÓN (SORPRESA, DISCULPAS, RAZONES) ====== */
    surpriseBtn.addEventListener('click', ()=>{
      finalBox.textContent = surpriseMessages[msgIndex];
      finalLove.style.display = "grid";
      requestAnimationFrame(()=> finalLove.classList.add('show'));
      setTimeout(()=>{
        finalLove.classList.remove('show');
        setTimeout(()=> finalLove.style.display="none", 380);
      }, 3400);
      msgIndex = (msgIndex+1) % surpriseMessages.length;
    });

    apologyBtn.addEventListener('click', () => {
        apologyModal.style.display = "grid";
        requestAnimationFrame(() => apologyModal.classList.add('show'));
    });

    closeApologyBtn.addEventListener('click', () => {
        apologyModal.classList.remove('show');
        setTimeout(() => apologyModal.style.display = "none", 380);
    });
    
    /* ====== SECRETO INTERACTIVO ====== */
    function typeSecretMessage(element, text, callback) {
        let i = 0;
        element.innerHTML = "";
        const interval = setInterval(() => {
            if (i < text.length) {
                element.innerHTML += text.charAt(i);
                i++;
            } else {
                clearInterval(interval);
                if (callback) callback();
            }
        }, 50);
    }

    secretHint.addEventListener('click', () => {
        secretOverlay.style.display = "grid";
        requestAnimationFrame(() => secretOverlay.classList.add('show'));
        
        typeSecretMessage(secretContent, SECRET_MESSAGE.trim(), () => {
            setTimeout(() => {
                secretOverlay.classList.remove('show');
                setTimeout(() => secretOverlay.style.display = "none", 500);
            }, 4000);
        });
    });
    
    /* ====== LLUVIA DE CORAZONES ====== */
    heroArea.addEventListener('click', function(e) {
        let heart = document.createElement('div');
        heart.className = 'heart-particle';
        heart.innerHTML = '💛';
        
        const rect = heroArea.getBoundingClientRect();
        const x = e.clientX - rect.left;
        const y = e.clientY - rect.top;
        heart.style.left = x + 'px';
        heart.style.top = y + 'px';
        
        const duration = Math.random() * 1.5 + 1;
        heart.style.animationDuration = duration + 's';
        
        heroArea.appendChild(heart);
        
        setTimeout(() => {
            heart.remove();
        }, duration * 1000);
    });
    
    /* ====== GENERADOR DE CUMPLIDOS ====== */
    let lastReasonIndex = -1;
    reasonBtn.addEventListener('click', () => {
        let randomIndex;
        do {
            randomIndex = Math.floor(Math.random() * LOVE_REASONS.length);
        } while (LOVE_REASONS.length > 1 && randomIndex === lastReasonIndex);
        
        lastReasonIndex = randomIndex;
        reasonText.textContent = `Te amo ${LOVE_REASONS[randomIndex]}`;
        
        reasonModal.style.display = "grid";
        requestAnimationFrame(() => reasonModal.classList.add('show'));
    });

    closeReasonBtn.addEventListener('click', () => {
        reasonModal.classList.remove('show');
        setTimeout(() => reasonModal.style.display = "none", 380);
    });

    /* ====== FLORES DECORATIVAS ====== */
    (function spawnDecor(){
      const count = 14;
      for(let i=0;i<count;i++){
        const f = document.createElement('img');
        f.src = FLOWER_IMG; f.alt = "Flor amarilla"; f.className='float-img';
        const dur = 12 + Math.random()*10;
        const delay = -Math.random()*dur;
        const left = Math.random()*100;
        const scale = (0.75 + Math.random()*0.8).toFixed(2);
        f.style.animationDuration = dur+'s';
        f.style.animationDelay = delay+'s';
        f.style.left = left+'%';
        f.style.setProperty('--s', scale);
        bgDecor.appendChild(f);
      }
    })();

    /* ====== VALIDACIÓN DE NOMBRES ====== */
    function validTwoWordsCap(s){
      return /^[A-ZÁÉÍÓÚÑa-záéíóúñ]+ [A-ZÁÉÍÓÚÑa-záéíóúñ]+$/.test(s);
    }

    limpiarBtn.addEventListener('click', ()=>{
      nombreInput.value = ""; nombreNovioInput.value = "";
      errorMsg.style.display = 'none'; okMsg.style.display = 'none';
    });

    validarBtn.addEventListener('click', ()=>{
      const her = nombreInput.value.trim();
      const him = nombreNovioInput.value.trim();

      if(!validTwoWordsCap(her) || !validTwoWordsCap(him)){
        okMsg.style.display='none';
        errorMsg.textContent = '❌ TA MAL ESCRITO :(';
        errorMsg.style.display='block';
        return;
      }
      
      if(her.toLowerCase() === REQUIRED_HER.toLowerCase() && him.toLowerCase() === REQUIRED_HIM.toLowerCase()){
        validatedHerName = her;
        errorMsg.style.display='none'; okMsg.style.display='block';
        document.getElementById('nameSection').style.display='none';
        quizWrap.style.display='block';
        if(!quizMount.hasChildNodes()) buildQuiz();
      }else{
        okMsg.style.display='none';
        errorMsg.textContent = '❌ Ingresaste mal los nombres :(';
        errorMsg.style.display='block';
      }
    });

    function buildQuiz(){
      QUIZ_QUESTIONS.forEach((item,idx)=>{
        const field = document.createElement('div');
        const q = document.createElement('p'); q.className='q';
        q.textContent = `${idx+1}. ${item.q}`; field.appendChild(q);
        item.options.forEach((opt,i)=>{
          const label = document.createElement('label'); label.className='option';
          label.innerHTML = `<input type="radio" name="q${idx}" value="${i}"> ${opt}`;
          field.appendChild(label);
        });
        quizMount.appendChild(field);
      });
    }

    quizForm.addEventListener('submit', (e)=>{
      e.preventDefault();
      let ok = 0;
      QUIZ_QUESTIONS.forEach((q,idx)=>{
        const val = quizForm.querySelector(`input[name=q${idx}]:checked`);
        if(val && Number(val.value)===q.answer) ok++;
      });
      if(ok===QUIZ_QUESTIONS.length){
        quizStatus.style.display='none';
        quizOk.style.display='block';
        setTimeout(()=>{
          gate.hidden = true;
          mainShell.hidden = false;
          mainFooter.hidden = false;
          startRomanceSequence();
        },700);
      }else{
        quizOk.style.display='none';
        quizStatus.textContent = `❌ Te faltó alguna: ${ok}/${QUIZ_QUESTIONS.length} correctas.`;
        quizStatus.style.display = 'block';
      }
    });

    /* ====== CARTA + SONIDO DE TECLAS (suave) ====== */
    const carta = `Querida ${REQUIRED_HER.split(' ')[0]} 💛

Hoy quiero regalarte no solo flores amarillas,
sino también mis palabras más sinceras.

Eres mi luz en los días nublados,
mi paz en el caos,
y mi sonrisa en cada momento.

Gracias por existir, gracias por amarme
y por dejarme amarte con todo mi corazón.

Me encargare de enamorarla cada dia hasta el resto de mi vida
Siempre estare para usted y velare por usted.

(Se supone que era el 21 pero le gano la ansiedad a usted y a mi JAJA)

Te amo con todo mi corazón. 
Eres y siempre serás el amor de mi vida, mi princesita hermosa.

Con todo mi amor,
Ivo ✨`;

    function typeLetter(text){
      loveLetter.textContent = "";
      let i = 0;
      const ctx = new (window.AudioContext||window.webkitAudioContext)();
      function playKeySound(){
        const osc = ctx.createOscillator();
        const gain = ctx.createGain();
        osc.type = "square";
        osc.frequency.value = 300; gain.gain.value = 0.008;
        osc.connect(gain); gain.connect(ctx.destination);
        osc.start(); osc.stop(ctx.currentTime + 0.03);
      }
      const interval = setInterval(()=>{
        loveLetter.textContent += text.charAt(i);
        if(text.charAt(i)!==" " && text.charAt(i)!=="\n"){ playKeySound(); }
        i++; if(i>=text.length) clearInterval(interval);
      }, 60);
    }

    function startRomanceSequence(){
      loveLetter.classList.add('visible');
      typeLetter(carta);
      setTimeout(()=> signature.classList.add('show'), 5200);
      setTimeout(()=>{
        musicBox.style.display='block';
        const start = music.play();
        if(start){ start.catch(()=>{}); }
      }, 1400);
    }
    
    /* ====== 🎶 LÓGICA DEL REPRODUCTOR DE MÚSICA ====== */
    function formatTime(seconds) {
      const minutes = Math.floor(seconds / 60);
      const secs = Math.floor(seconds % 60);
      return `${minutes.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
    }

    function togglePlayPause() {
      if (music.paused) { music.play(); } else { music.pause(); }
    }
    
    music.addEventListener('play', () => {
      playIcon.style.display = 'none'; pauseIcon.style.display = 'block';
    });

    music.addEventListener('pause', () => {
      playIcon.style.display = 'block'; pauseIcon.style.display = 'none';
    });
    
    music.addEventListener('loadedmetadata', () => {
      totalTimeEl.textContent = formatTime(music.duration);
    });

    music.addEventListener('timeupdate', () => {
      progressBar.style.width = `${(music.currentTime / music.duration) * 100}%`;
      currentTimeEl.textContent = formatTime(music.currentTime);
    });
    
    function seek(event) {
      music.currentTime = (event.offsetX / progressContainer.clientWidth) * music.duration;
    }

    function setVolume(event){
      music.volume = event.target.value / 100;
    }

    playPauseBtn.addEventListener('click', togglePlayPause);
    progressContainer.addEventListener('click', seek);
    volumeSlider.addEventListener('input', setVolume);

    /* ====== FOOTER FRASES ====== */
    let fIndex = 0;
    function updateFooterPhrase(){
      footerPhraseEl.style.opacity = "0";
      setTimeout(()=>{
        footerPhraseEl.textContent = footerPhrases[fIndex];
        footerPhraseEl.style.opacity = "1";
        fIndex = (fIndex+1) % footerPhrases.length;
      }, 300);
    }
    updateFooterPhrase(); setInterval(updateFooterPhrase, 9000);

</script>
</body>
</html>
